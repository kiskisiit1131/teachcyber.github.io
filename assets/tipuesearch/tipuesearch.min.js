(function(e){e.fn.tipuesearch=function(t){var s=e.extend({contentLocation:"tipuesearch/tipuesearch_content.json",contextBuffer:60,contextLength:60,contextStart:90,debug:!1,descriptiveWords:25,highlightTerms:!0,liveContent:"*",liveDescription:"*",minimumLength:3,mode:"static",newWindow:!1,show:9,showContext:!0,showRelated:!0,showTime:!0,showTitleCount:!0,showURL:!0,wholeWords:!0,showTags:!1},t);return this.each(function(){function t(e){var t=location.search,s=new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(t)||[,""],i=s[1].replace(/\+/g,"%20");try{i=decodeURIComponent(i)}catch(e){i=unescape(i)}return i||null}function i(t,c){function h(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var o="",l=!1,p=!1,_=!0,u=0;found=[];var g=e("#tipue_search_input").val(),d=g.toLowerCase();d=e.trim(d),d=h(d),(d.match('^"')&&d.match('"$')||d.match("^'")&&d.match("'$"))&&(_=!1);var f=d.split(" ");if(_){d="";for(var v=0;v<f.length;v++){for(var w=!0,m=0;m<tipuesearch_stop_words.length;m++)f[v]==tipuesearch_stop_words[m]&&(w=!1,p=!0);w&&(d=d+" "+f[v])}d=e.trim(d),f=d.split(" ")}else d=d.substring(1,d.length-1);if(d.length>=s.minimumLength){if(_){if(c){var x=d;for(v=0;v<f.length;v++)for(m=0;m<tipuesearch_replace.words.length;m++)f[v]==tipuesearch_replace.words[m].word&&(d=d.replace(f[v],tipuesearch_replace.words[m].replace_with),l=!0);f=d.split(" ")}var b=d;for(v=0;v<f.length;v++)for(m=0;m<tipuesearch_stem.words.length;m++)f[v]==tipuesearch_stem.words[m].word&&(b=b+" "+tipuesearch_stem.words[m].stem);f=b.split(" ");for(v=0;v<a.pages.length;v++){var L=0,C=a.pages[v].text;for(m=0;m<f.length;m++){if(s.wholeWords)var T=new RegExp("\\b"+f[m]+"\\b","gi");else T=new RegExp(f[m],"gi");if(-1!=a.pages[v].title.search(T)){var R=a.pages[v].title.match(T).length;L+=20*R}if(-1!=a.pages[v].text.search(T)){R=a.pages[v].text.match(T).length;L+=20*R}if(-1!=a.pages[v].tags.search(T)){R=a.pages[v].tags.match(T).length;L+=10*R}if(-1!=a.pages[v].url.search(T)&&(L+=20),0!=L)for(var k=0;k<tipuesearch_weight.weight.length;k++)a.pages[v].url==tipuesearch_weight.weight[k].url&&(L+=tipuesearch_weight.weight[k].score);f[m].match("^-")&&(T=new RegExp(f[m].substring(1),"i"),-1==a.pages[v].title.search(T)&&-1==a.pages[v].text.search(T)&&-1==a.pages[v].tags.search(T)||(L=0))}0!=L&&(found.push({score:L,title:a.pages[v].title,desc:C,tags:a.pages[v].tags,url:a.pages[v].url}),u++)}}else for(v=0;v<a.pages.length;v++){L=0,C=a.pages[v].text,T=new RegExp(d,"gi");if(-1!=a.pages[v].title.search(T)){R=a.pages[v].title.match(T).length;L+=20*R}if(-1!=a.pages[v].text.search(T)){R=a.pages[v].text.match(T).length;L+=20*R}if(-1!=a.pages[v].tags.search(T)){R=a.pages[v].tags.match(T).length;L+=10*R}if(-1!=a.pages[v].url.search(T)&&(L+=20),0!=L)for(k=0;k<tipuesearch_weight.weight.length;k++)a.pages[v].url==tipuesearch_weight.weight[k].url&&(L+=tipuesearch_weight.weight[k].score);0!=L&&(found.push({score:L,title:a.pages[v].title,desc:C,tags:a.pages[v].tags,url:a.pages[v].url}),u++)}if(0!=u){if(s.showTitleCount&&0==r){var y=document.title;document.title="("+u+") "+y,r++}if(l&&(o+='<div id="tipue_search_warning">'+tipuesearch_string_2+" "+d+". "+tipuesearch_string_3+' <a id="tipue_search_replaced">'+x+"</a></div>"),1==u?o+='<div id="tipue_search_results_count">'+tipuesearch_string_4:(c_c=u.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),o+='<div id="tipue_search_results_count">'+c_c+" "+tipuesearch_string_5),s.showTime){var E=(new Date).getTime(),W=(E-startTimer)/1e3;o+=" ("+W.toFixed(2)+" "+tipuesearch_string_14+")",s.showTime=!1}o+="</div>",found.sort(function(e,t){return t.score-e.score});var $=0;for(v=0;v<found.length;v++){if($>=t&&$<s.show+t){if(o+='<div class="tipue_search_content_title"><a href="'+found[v].url+'"'+n+">"+found[v].title+"</a></div>",s.debug&&(o+='<div class="tipue_search_content_debug">Score: '+found[v].score+"</div>"),s.showTags&&""!=found[v].tags&&(o+='<div class="tipue_search_content_text">Tags: '+found[v].tags+"</div>"),s.showURL){var O=found[v].url.toLowerCase();0==O.indexOf("http://")&&(O=O.slice(7)),o+='<div class="tipue_search_content_url"><a href="'+found[v].url+'"'+n+">"+O+"</a></div>"}if(found[v].desc){var S=found[v].desc;if(s.showContext){f=d.split(" ");var j=found[v].desc.toLowerCase().indexOf(f[0]);if(j>s.contextStart){var B=S.substr(j-s.contextBuffer),D=B.indexOf(" ");B=S.substr(j-s.contextBuffer+D),B=e.trim(B),B.length>s.contextLength&&(S="... "+B)}}if(_){f=d.split(" ");for(m=0;m<f.length;m++)if(s.highlightTerms){var U=new RegExp("("+f[m]+")","gi");S=S.replace(U,"<h0011>$1<h0012>")}}else if(s.highlightTerms){U=new RegExp("("+d+")","gi");S=S.replace(U,'<span class="tipue_search_content_bold">$1</span>')}var q="",I=S.split(" ");if(I.length<s.descriptiveWords)q=S;else for(m=0;m<s.descriptiveWords;m++)q+=I[m]+" ";q=e.trim(q),"."!=q.charAt(q.length-1)&&(q+=" ..."),q=q.replace(/h0011/g,'span class="tipue_search_content_bold"'),q=q.replace(/h0012/g,"/span"),o+='<div class="tipue_search_content_text">'+q+"</div>"}}$++}if(s.showRelated&&_){m=0;for(v=0;v<tipuesearch_related.searches.length;v++)d==tipuesearch_related.searches[v].search&&(l&&(g=d),m||(o+='<div class="tipue_search_related_title">'+tipuesearch_string_15+' <span class="tipue_search_related_bold">'+g+'</span></div><div class="tipue_search_related_cols">'),o+='<div class="tipue_search_related_text"><a class="tipue_search_related" id="'+tipuesearch_related.searches[v].related+'">',tipuesearch_related.searches[v].before&&(o+='<span class="tipue_search_related_before">'+tipuesearch_related.searches[v].before+"</span> "),o+=tipuesearch_related.searches[v].related,tipuesearch_related.searches[v].after&&(o+=' <span class="tipue_search_related_after">'+tipuesearch_related.searches[v].after+"</span>"),o+="</a></div>",m++);m&&(o+="</div>")}if(u>s.show){var A=Math.ceil(u/s.show),F=t/s.show;if(o+='<nav><div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">',t>0&&(o+='<li role="navigation"><a class="tipue_search_foot_box" accesskey="b" id="'+(t-s.show)+"_"+c+'">'+tipuesearch_string_6+"</a></li>"),F<=2){var J=A;A>3&&(J=3);for(m=0;m<J;m++)o+=m==F?'<li class="current" role="navigation">'+(m+1)+"</li>":'<li role="navigation"><a class="tipue_search_foot_box" id="'+m*s.show+"_"+c+'">'+(m+1)+"</a></li>"}else{J=F+2;J>A&&(J=A);for(m=F-1;m<J;m++)o+=m==F?'<li class="current" role="navigation">'+(m+1)+"</li>":'<li role="navigation"><a class="tipue_search_foot_box" id="'+m*s.show+"_"+c+'">'+(m+1)+"</a></li>"}F+1!=A&&(o+='<li role="navigation"><a class="tipue_search_foot_box" accesskey="m" id="'+(t+s.show)+"_"+c+'">'+tipuesearch_string_7+"</a></li>"),o+="</ul></div></nav>"}}else o+='<div id="tipue_search_warning">'+tipuesearch_string_8+"</div>"}else p?o+='<div id="tipue_search_warning">'+tipuesearch_string_8+". "+tipuesearch_string_9+"</div>":(o+='<div id="tipue_search_warning">'+tipuesearch_string_10+"</div>",1==s.minimumLength?o+='<div id="tipue_search_warning">'+tipuesearch_string_11+"</div>":o+='<div id="tipue_search_warning">'+tipuesearch_string_12+" "+s.minimumLength+" "+tipuesearch_string_13+"</div>");e("#tipue_search_content").hide().html(o).slideDown(200),e("#tipue_search_replaced").click(function(){i(0,!1)}),e(".tipue_search_related").click(function(){e("#tipue_search_input").val(e(this).attr("id")),i(0,!0)}),e(".tipue_search_foot_box").click(function(){var t=e(this).attr("id"),s=t.split("_");i(parseInt(s[0]),s[1])})}var a={pages:[]};e.ajaxSetup({async:!1});var r=0;if(e("#tipue_search_content").hide().html('<div class="tipue_search_spinner"><div class="tipue_search_rect1"></div><div class="tipue_search_rect2"></div><div class="rect3"></div></div>').show(),"live"==s.mode)for(var c=0;c<tipuesearch_pages.length;c++)e.get(tipuesearch_pages[c]).done(function(t){var i=e(s.liveContent,t).text();i=i.replace(/\s+/g," ");var r=e(s.liveDescription,t).text();r=r.replace(/\s+/g," ");var n=t.toLowerCase().indexOf("<title>"),h=t.toLowerCase().indexOf("</title>",n+7);if(-1!=n&&-1!=h)var o=t.slice(n+7,h);else o=tipuesearch_string_1;a.pages.push({title:o,text:r,tags:i,url:tipuesearch_pages[c]})});"json"==s.mode&&e.getJSON(s.contentLocation).done(function(t){a=e.extend({},t)}),"static"==s.mode&&(a=e.extend({},tipuesearch));var n="";s.newWindow&&(n=' target="_blank"'),t("q")&&(e("#tipue_search_input").val(t("q")),i(0,!0)),e(this).keyup(function(e){"13"==e.keyCode&&i(0,!0)})})}})(jQuery);